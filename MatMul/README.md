# Лабораторная работа 1 :octocat:
## Перемножение матриц
**Задача**: реализовать алгоритм перемножения матриц<br/>
**Язык**: Python<br/>
**Входные данные**: 2 матрицы размером от 100 х 100 до 2000 х 2000 каждая<br/>
**Выходные данные**: проверка корректности перемножения + время вычисления<br/>
## **Техническое обеспечение**
+ Процессор: Intel(R) Xeon(R) CPU @ 2.30GHz
+ Графический процессор: Tesla K80
+ Чип: Apple M1 (для сравнения вычислений, полученных с Google Colaboratory)
## **Описание**
Язык Python 3.7 с использованием библиотек Numba, Numpy.
В программе реализованы три функции: 
+ ```MM_CPU``` - функция перемножение матриц на CPU с помощью встроенной функции ```np.dot()``` в библиотеке Numpy.
+ ```matmul_CPU``` - функция перемножение матриц на CPU.
+ ```matmul_GPU``` - функция перемножение матриц на GPU путем реализацией ядра с общей памятью.
Перемножение в ```matmul_CPU``` выполнено с помощью циклов. В ```matmul_GPU``` был использован JIT компилятор ```cuda.jit```, который переводит код, написанный в Python, в машинный код.

## **Результаты**
В таблице приведены результаты расчета случайно сгенерированных матриц на CPU и GPU соответственно:
Размер матрицы | Расчет на CPU | Расчет на GPU | "Ускорение"
------------ | ------------- | ------------- | -------------
777 | 0.0017 | 0.0641 | 0.0015
990 | 0.0014 | 0.1301 | 0.0112
1602 | 0.0016 | 1.1125 | 0.0277

На основе полученных данных был построен график:

![CPU_GPU_SpeedTest](https://drive.google.com/uc?export=view&id=1Ldh_tCyCMnHRVXcbxZ6Zk_1oHZIIGNg2)
<br/>
По оси X - размер матрицы;<br/>
По оси Y - время выполнения расчета перемножения матриц.<br/>

Корректность перемножения матриц была осуществлена с помощью ```np.allclose()```, если в ответ выводилось ```True``` , значит матрицы, расчитанные двумя функциями, одинаковы.

## **Заключение**
По результат можно сделать неоднозначный вывод, с одной стороны известно, что GPU значительно ускоряет процесс вычисления различных математических задач по сравнению с вычислением на CPU. Но по полученным данным получилось всё наоборот: CPU вычисляет в 37, 100 и 695 раз быстрее, чем GPU. <br/>
Возможно, [ключевую роль](https://erik-engheim.medium.com/apple-m1-foreshadows-risc-v-dd63a62b2562) в таком превосходстве CPU сыграл чип М1 так как есть одна важная мелочь, которую нужно запомнить: М1 - это не только CPU. Это система множества чипов, лежащих в одной кремниевой обертке. CPU же - это один из этих чипов. Технически, М1 - это весь компьютер на одном чипе. Он содержит CPU, графический процессор GPU, память, контроллеры I/O и множество других вещей, делающих компьютер компьютером, так называемой системой на чипе (system on the chip, SoC).
